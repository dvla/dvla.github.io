<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Postman-Paf-js | DVLA Engineering</title><meta name=keywords content="JavaScript"><meta name=description content="Open Source library to apply Royal Mail Rules & Exceptions to PAF (Postcode Address File) addresses when converting to a printable format."><meta name=author content="Nathan Morris"><link rel=canonical href=https://dvla.github.io/posts/2025-02-postman-paf/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://dvla.github.io/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://dvla.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://dvla.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://dvla.github.io/favicon/apple-touch-icon.png><link rel=mask-icon href=https://dvla.github.io/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://dvla.github.io/posts/2025-02-postman-paf/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WH4N9FEEE8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WH4N9FEEE8")}</script><meta property="og:url" content="https://dvla.github.io/posts/2025-02-postman-paf/"><meta property="og:site_name" content="DVLA Engineering"><meta property="og:title" content="Postman-Paf-js"><meta property="og:description" content="Open Source library to apply Royal Mail Rules & Exceptions to PAF (Postcode Address File) addresses when converting to a printable format."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-06T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-06T00:00:00+00:00"><meta property="article:tag" content="JavaScript"><meta property="og:image" content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Postman-Paf-js"><meta name=twitter:description content="Open Source library to apply Royal Mail Rules & Exceptions to PAF (Postcode Address File) addresses when converting to a printable format."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://dvla.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Postman-Paf-js","item":"https://dvla.github.io/posts/2025-02-postman-paf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Postman-Paf-js","name":"Postman-Paf-js","description":"Open Source library to apply Royal Mail Rules \u0026 Exceptions to PAF (Postcode Address File) addresses when converting to a printable format.","keywords":["JavaScript"],"articleBody":"Postman-Paf-js We’ve recently released a library called postman-paf-js that we use to apply Royal Mail rules \u0026 exceptions to PAF (Postcode Address File) addresses when converting to a printable format. We also have a ruby implementation.\nWhy is Postman Paf required? To put it simply, UK addresses are more complicated than they might seem. But aren’t addresses just a few set lines that appear on your letters? Unfortunately, it’s not that simple! Most addresses in the UK are stored in a database called the Postal Address File (PAF), which is owned and managed by the Royal Mail. This database includes over 30 million UK postal delivery addresses and 1.8 million postcodes. However, these addresses are not stored in the familiar format you see on your envelope. Instead, they are stored in a specific data structure, as shown here\nExample of a PAF address\n{ \"thoroughfareName\": \"NORTH EAST SECTOR\", \"doubleDependentLocality\": \"BOURNEMOUTH INTERNATIONAL AIRPORT\", \"postcode\": \"BH23 6NE\", \"dependentLocality\": \"HURN\", \"postTown\": \"CHRISTCHURCH\", \"buildingName\": \"A B P 21\", \"organisationName\": \"BREATHE SAFETY LTD\" } This data is structured very differently from the address format that appears on your envelope. Before these PAF addresses (which we at the DVLA call “Structured Addresses”) can be used for postal mail, they must be converted into a format recognized by the Royal Mail. We refer to addresses in this format as “Unstructured Addresses.”\nRules are rules To convert addresses from a Structured format to an Unstructured format, certain rules must be applied to each element of the address to ensure it is ordered correctly. The Royal Mail has provided a developer guide detailing how to correctly perform this conversion, which includes several rules and exceptions that need to be followed in the correct order.\nThere are 4 ordering notes, 7 rules, and 4 exceptions that must be applied to a PAF address, all in the correct order, to ensure it is converted according to the Royal Mail’s guidelines.\nConversion example step by step An example of the process followed on converting a Structured address to an unstructured address can be found below:\n{ \"structuredAddress\": { \"buildingName\": \"ENDEAVOUR QUAY\", \"subBuildingName\": \"THE DESIGN OFFICE\", \"thoroughfareName\": \"MUMBY ROAD\", \"postcode\": \"PO12 1AH\", \"postTown\": \"GOSPORT\" } } Step 1 - Order premises elements Rule 6 applies Address has a sub building name and building name.\nCheck the format of Sub Building Name. If an Exception Rule applies, the Sub Building Name should appear on the same line as, and before, the Building Name Check format of Building Name, If an Exception Rule applies, the Building Name should appear at the beginning of the first Thoroughfare line, or the first Locality line if there is no Thoroughfare information.\nIn this case none of these exceptions apply.\nOtherwise, the Sub Building Name should appear on a line preceding the Building Name, Thoroughfare and Locality information.\n{ \"line1\": \"THE DESIGN OFFICE\", \"line2\": \"ENDEAVOUR QUAY\" } Step 2 - Order Thoroughfare/locality { \"line1\": \"THE DESIGN OFFICE\", \"line2\": \"ENDEAVOUR QUAY\", \"line3\": \"MUMBY ROAD\" } Step 3 - Add in post town and postcode { \"line1\": \"THE DESIGN OFFICE\", \"line2\": \"ENDEAVOUR QUAY\", \"line3\": \"MUMBY ROAD\", \"line5\": \"GOSPORT\", \"postcode\": \"PO12 1AH\" } How we did it Originally, the address converter library was written in Java and forked from an existing library: paf-address-format. However, this library was relatively old (last updated 5 years ago) and did not conform to all the up-to-date rules and exceptions outlined in the latest Royal Mail Developers Guide.\nTo ensure the library could correctly handle every rule and exception, the DVLA team painstakingly tested each rule and exception individually. This process involved using the notes and examples from the Royal Mail Developer’s Guide, testing sets of PAF addresses from a PAF dataset, and comparing results against the Royal Mail Postcode Finder. After the conversion library was manually tested, a comprehensive test pack was created consisting of 92 tests and 1,380 assertions to thoroughly verify each rule and exception.\nSince JavaScript is widely used across the DVLA in applications requiring structured addresses to be converted, the team decided to undertake the task of creating a JavaScript version of the original Java library. The code was ported from Java to JavaScript and then thoroughly tested again using the same tests and tools developed during the improvements made to the Java library. The JavaScript library has since been posted publicly on GitHub to provide access to the developer community.\nWe currently use the library within our internal Addressing services where it is helping us handle millions of addresses per year UK driver and vehicle transactions.\nHow to use the library The library is simple to use, the convertStructuredToUnstructured function needs to be imported from the library then simply pass in a structured address.\nconst { convertStructuredToUnstructured } = require('postman-paf-js'); const structuredAddressToConvert = { buildingNumber: '1', thoroughfareName: 'Example Street', postTown: 'City', postcode: 'AA1 1AA', }; const convertedUnstructuredAddress = convertStructuredToUnstructured(structuredAddressToConvert); The function will then return an unstructured (Address with up to 5 lines and a postcode ) in the royal mail format\nconvertedUnstructuredAddress = { line1: '1 Example Street', line5: 'City', postcode: 'AA1 1AA', }; ","wordCount":"843","inLanguage":"en","image":"https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-02-06T00:00:00Z","dateModified":"2025-02-06T00:00:00Z","author":{"@type":"Person","name":"Nathan Morris"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dvla.github.io/posts/2025-02-postman-paf/"},"publisher":{"@type":"Organization","name":"DVLA Engineering","logo":{"@type":"ImageObject","url":"https://dvla.github.io/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://dvla.github.io/ accesskey=h title="DVLA Engineering (Alt + H)"><img src=https://dvla.github.io/favicon/apple-touch-icon.png alt aria-label=logo height=49>DVLA Engineering</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://dvla.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://dvla.github.io/open-source/ title=Open-source><span>Open-source</span></a></li><li><a href=https://github.com/dvla/ title=Github><span>Github</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.civil-service-careers.gov.uk/departments/working-for-the-driver-and-vehicle-licensing-agency/ title=Careers><span>Careers</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://dvla.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://dvla.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Postman-Paf-js</h1><div class=post-description>Open Source library to apply Royal Mail Rules & Exceptions to PAF (Postcode Address File) addresses when converting to a printable format.</div><div class=post-meta><span title='2025-02-06 00:00:00 +0000 UTC'>February 6, 2025</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;843 words&nbsp;·&nbsp;Nathan Morris</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#postman-paf-js>Postman-Paf-js</a></li><li><a href=#why-is-postman-paf-required>Why is Postman Paf required?</a></li><li><a href=#rules-are-rules>Rules are rules</a></li><li><a href=#conversion-example-step-by-step>Conversion example step by step</a><ul><li><a href=#step-1---order-premises-elements>Step 1 - Order premises elements</a></li><li><a href=#step-2---order-thoroughfarelocality>Step 2 - Order Thoroughfare/locality</a></li><li><a href=#step-3---add-in-post-town-and-postcode>Step 3 - Add in post town and postcode</a></li></ul></li><li><a href=#how-we-did-it>How we did it</a></li><li><a href=#how-to-use-the-library>How to use the library</a></li></ul></nav></div></details></div><div class=post-content><h2 id=postman-paf-js>Postman-Paf-js<a hidden class=anchor aria-hidden=true href=#postman-paf-js>#</a></h2><p>We&rsquo;ve recently released a library called <a href=https://github.com/dvla/postman-paf-js>postman-paf-js</a> that we use to apply Royal Mail rules & exceptions to PAF (Postcode Address File) addresses when converting to a printable format. We also have a <a href=https://github.com/dvla/postman-paf>ruby implementation</a>.</p><h2 id=why-is-postman-paf-required>Why is Postman Paf required?<a hidden class=anchor aria-hidden=true href=#why-is-postman-paf-required>#</a></h2><p>To put it simply, UK addresses are more complicated than they might seem. But aren&rsquo;t addresses just a few set lines that appear on your letters? Unfortunately, it&rsquo;s not that simple! Most addresses in the UK are stored in a database called the Postal Address File (PAF), which is owned and managed by the
Royal Mail. This database includes over 30 million UK postal delivery addresses and 1.8 million postcodes. However, these addresses are not stored in the familiar format you
see on your envelope. Instead, they are stored in a specific data structure, as shown
<a href="https://www.poweredbypaf.com/wp-content/uploads/2017/07/Latest-Programmers_guide_Edition-7-Version-6-1.pdf#page=12">here</a></p><p>Example of a PAF address</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;thoroughfareName&#34;</span><span class=p>:</span> <span class=s2>&#34;NORTH EAST SECTOR&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;doubleDependentLocality&#34;</span><span class=p>:</span> <span class=s2>&#34;BOURNEMOUTH INTERNATIONAL AIRPORT&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;postcode&#34;</span><span class=p>:</span> <span class=s2>&#34;BH23 6NE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;dependentLocality&#34;</span><span class=p>:</span> <span class=s2>&#34;HURN&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;postTown&#34;</span><span class=p>:</span> <span class=s2>&#34;CHRISTCHURCH&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;buildingName&#34;</span><span class=p>:</span> <span class=s2>&#34;A B P 21&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;organisationName&#34;</span><span class=p>:</span> <span class=s2>&#34;BREATHE SAFETY LTD&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>This data is structured very differently from the address format that appears on your envelope. Before these PAF addresses (which we at the DVLA call &ldquo;Structured Addresses&rdquo;)
can be used for postal mail, they must be converted into a format recognized by the Royal Mail. We refer to addresses in this format as &ldquo;Unstructured Addresses.&rdquo;</p><h2 id=rules-are-rules>Rules are rules<a hidden class=anchor aria-hidden=true href=#rules-are-rules>#</a></h2><p>To convert addresses from a Structured format to an Unstructured format, certain rules must be applied to each element of the address to ensure it is ordered correctly.
The Royal Mail has provided a developer guide detailing how to correctly perform this conversion, which includes several rules and exceptions that need to be followed
in the correct order.</p><p>There are 4 ordering notes, 7 rules, and 4 exceptions that must be applied to a PAF address, all in the correct order, to ensure it is converted according to the Royal
Mail&rsquo;s guidelines.</p><h2 id=conversion-example-step-by-step>Conversion example step by step<a hidden class=anchor aria-hidden=true href=#conversion-example-step-by-step>#</a></h2><p>An example of the process followed on converting a Structured address to an unstructured address can be found below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;structuredAddress&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=nt>&#34;buildingName&#34;</span><span class=p>:</span> <span class=s2>&#34;ENDEAVOUR QUAY&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nt>&#34;subBuildingName&#34;</span><span class=p>:</span> <span class=s2>&#34;THE DESIGN OFFICE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nt>&#34;thoroughfareName&#34;</span><span class=p>:</span> <span class=s2>&#34;MUMBY ROAD&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nt>&#34;postcode&#34;</span><span class=p>:</span> <span class=s2>&#34;PO12 1AH&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nt>&#34;postTown&#34;</span><span class=p>:</span> <span class=s2>&#34;GOSPORT&#34;</span>
</span></span><span class=line><span class=cl>   <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=step-1---order-premises-elements>Step 1 - Order premises elements<a hidden class=anchor aria-hidden=true href=#step-1---order-premises-elements>#</a></h3><p>Rule 6 applies Address has a sub building name and building name.</p><p>Check the format of Sub Building Name. If an Exception Rule applies, the Sub Building Name should appear on the same line as, and before, the Building Name
Check format of Building Name, If an Exception Rule applies, the Building Name should appear at the beginning of the first Thoroughfare line, or the first Locality
line if there is no Thoroughfare information.</p><p>In this case none of these exceptions apply.</p><p>Otherwise, the Sub Building Name should appear on a line preceding the Building Name, Thoroughfare and Locality information.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;line1&#34;</span><span class=p>:</span> <span class=s2>&#34;THE DESIGN OFFICE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=nt>&#34;line2&#34;</span><span class=p>:</span> <span class=s2>&#34;ENDEAVOUR QUAY&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=step-2---order-thoroughfarelocality>Step 2 - Order Thoroughfare/locality<a hidden class=anchor aria-hidden=true href=#step-2---order-thoroughfarelocality>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;line1&#34;</span><span class=p>:</span> <span class=s2>&#34;THE DESIGN OFFICE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;line2&#34;</span><span class=p>:</span> <span class=s2>&#34;ENDEAVOUR QUAY&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;line3&#34;</span><span class=p>:</span> <span class=s2>&#34;MUMBY ROAD&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=step-3---add-in-post-town-and-postcode>Step 3 - Add in post town and postcode<a hidden class=anchor aria-hidden=true href=#step-3---add-in-post-town-and-postcode>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;line1&#34;</span><span class=p>:</span> <span class=s2>&#34;THE DESIGN OFFICE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;line2&#34;</span><span class=p>:</span> <span class=s2>&#34;ENDEAVOUR QUAY&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;line3&#34;</span><span class=p>:</span> <span class=s2>&#34;MUMBY ROAD&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;line5&#34;</span><span class=p>:</span> <span class=s2>&#34;GOSPORT&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;postcode&#34;</span><span class=p>:</span> <span class=s2>&#34;PO12 1AH&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=how-we-did-it>How we did it<a hidden class=anchor aria-hidden=true href=#how-we-did-it>#</a></h2><p>Originally, the address converter library was written in Java and forked from an existing library: <a href=https://github.com/steinfletcher/paf-address-format>paf-address-format</a>. However, this library was relatively old (last updated 5 years ago) and did not conform to all the up-to-date rules and exceptions outlined in the latest Royal Mail Developers Guide.</p><p>To ensure the library could correctly handle every rule and exception, the DVLA team painstakingly tested each rule and exception individually. This process involved using the notes and examples from the Royal Mail Developer&rsquo;s Guide, testing sets of PAF addresses from a PAF dataset, and comparing results against the Royal Mail Postcode Finder. After the conversion library was manually tested, a comprehensive test pack was created consisting of 92 tests and 1,380 assertions to thoroughly verify each rule and exception.</p><p>Since JavaScript is widely used across the DVLA in applications requiring structured addresses to be converted, the team decided to undertake the task of creating a JavaScript version of the original Java library. The code was ported from Java to JavaScript and then thoroughly tested again using the same tests and tools developed during the improvements made to the Java library. The JavaScript library has since been posted publicly on GitHub to provide access to the developer community.</p><p>We currently use the library within our internal Addressing services where it is helping us handle millions of addresses per year UK driver and vehicle transactions.</p><h2 id=how-to-use-the-library>How to use the library<a hidden class=anchor aria-hidden=true href=#how-to-use-the-library>#</a></h2><p>The library is simple to use, the convertStructuredToUnstructured function needs to be imported from the library then simply pass in a structured address.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>convertStructuredToUnstructured</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;postman-paf-js&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>structuredAddressToConvert</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>buildingNumber</span><span class=o>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>thoroughfareName</span><span class=o>:</span> <span class=s1>&#39;Example Street&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>postTown</span><span class=o>:</span> <span class=s1>&#39;City&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>postcode</span><span class=o>:</span> <span class=s1>&#39;AA1 1AA&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>convertedUnstructuredAddress</span> <span class=o>=</span> <span class=nx>convertStructuredToUnstructured</span><span class=p>(</span><span class=nx>structuredAddressToConvert</span><span class=p>);</span>
</span></span></code></pre></div><p>The function will then return an unstructured (Address with up to 5 lines and a postcode ) in the royal mail format</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>convertedUnstructuredAddress</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>line1</span><span class=o>:</span> <span class=s1>&#39;1 Example Street&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>line5</span><span class=o>:</span> <span class=s1>&#39;City&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>postcode</span><span class=o>:</span> <span class=s1>&#39;AA1 1AA&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://dvla.github.io/tags/javascript/>JavaScript</a></li></ul><nav class=paginav><a class=prev href=https://dvla.github.io/posts/2024-12-using-max-by-in-ruby/><span class=title>« Prev</span><br><span>TiL: Using the max_by method in Ruby</span>
</a><a class=next href=https://dvla.github.io/posts/2024-10-toggle-ruby-tests-through-ci-secrets/><span class=title>Next »</span><br><span>Toggling Ruby scenarios in Drone using secrets</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://dvla.github.io/>DVLA Engineering</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>