<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TiL: Adding numerous tags to ParallelTests in cucumber elegantly | DVLA Engineering</title><meta name=keywords content="Ruby,ParallelTests,Tags,Cucumber,Testing,Today I Learned"><meta name=description content="Creating numerous tags to be included/excluded for ParallelTests in cucumber elegantly"><meta name=author content="Tomos Griffiths"><link rel=canonical href=https://dvla.github.io/posts/2024-07-adding-numerous-tags-to-paralleltests-in-cucumber-elegantly/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://dvla.github.io/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://dvla.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://dvla.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://dvla.github.io/favicon/apple-touch-icon.png><link rel=mask-icon href=https://dvla.github.io/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WH4N9FEEE8"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WH4N9FEEE8",{anonymize_ip:!1})}</script><meta property="og:title" content="TiL: Adding numerous tags to ParallelTests in cucumber elegantly "><meta property="og:description" content="Creating numerous tags to be included/excluded for ParallelTests in cucumber elegantly"><meta property="og:type" content="article"><meta property="og:url" content="https://dvla.github.io/posts/2024-07-adding-numerous-tags-to-paralleltests-in-cucumber-elegantly/"><meta property="og:image" content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-07-02T00:00:00+00:00"><meta property="article:modified_time" content="2024-07-02T00:00:00+00:00"><meta property="og:site_name" content="DVLA Engineering"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="TiL: Adding numerous tags to ParallelTests in cucumber elegantly "><meta name=twitter:description content="Creating numerous tags to be included/excluded for ParallelTests in cucumber elegantly"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://dvla.github.io/posts/"},{"@type":"ListItem","position":2,"name":"TiL: Adding numerous tags to ParallelTests in cucumber elegantly ","item":"https://dvla.github.io/posts/2024-07-adding-numerous-tags-to-paralleltests-in-cucumber-elegantly/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TiL: Adding numerous tags to ParallelTests in cucumber elegantly ","name":"TiL: Adding numerous tags to ParallelTests in cucumber elegantly ","description":"Creating numerous tags to be included/excluded for ParallelTests in cucumber elegantly","keywords":["Ruby","ParallelTests","Tags","Cucumber","Testing","Today I Learned"],"articleBody":"Trying to run tests in parallel in your CI/CD pipeline is tricky at the best of times, but what if you have tests which should only be run in a certain environment and not as part of the CI build stage?\nIt is fairly simple to just tag a feature file with a unique tag that can then be passed to the bundle exec rake command in the functional-tests step, as an environment variable. However, this tag will not stop these tests being run as part of the CI stage unless you make changes to how the tags are being used.\nA useful way is by adopting the approach described below:\nUsing ‘included’ and ’excluded’ tags By using a set of included and excluded tags, we can pass in the tags we want to use within a particular rake task, and also the tags we want to exclude from this task. We can do this easily and elegantly by using an array for each as below:\n# To exclude more tags in the running of the tests, add the argument to the 'excluded_tags' array below task :run, %i[threads feature_path tags excluded_tags] do |_t, args| args.with_defaults(threads: '1', feature_path: 'features', tags: '[]', excluded_tags: \"['@exclude']\") # puts the array of excluded_tags into a string to use in the tags argument below excluded_tags = JSON.parse(args.excluded_tags).map { |tag| \"not #{tag}\" } included_tags = JSON.parse(args.tags) tags = included_tags.concat(excluded_tags).join(' and ') # tags = args.tag.nil? ? 'not @problematic and not @retention' : args.tag LOG.info { \"Threads: '#{args.threads}' | Feature path: '#{args.feature_path}' | Tags: '#{tags}' | Formatter: '#{cucumber_formatter}'\" } parallel.run(['-n', args.threads, '--type', 'cucumber', '--group-by', 'scenarios', '--serialize-stdout', '--', '-f', cucumber_formatter, '--out', '/dev/null', '-f', 'progress', '-t', tags, '--', args.feature_path]) end The tags can then be passed in to the parallel.run command we are all familiar with. This ensures that we are running the tests that have been tagged appropriately but also excludes any tags that should not be added to this command.\nIn your drone.yml file, be sure to use the escape character () correctly in order to pass in the tags correctly, i.e.\nbundle exec rake \"functional_tests:run[1, features/tests, [\\\"@included_tag\\\"], [\\\"@excluded_tag\\\"]]\" # 1 included tag, 1 excluded tag OR bundle exec rake \"functional_tests:run[2, features/tests, [], [\\\"@excluded_tag1\\\" \\,\\ \\\"@excluded_tag2\\\"]]\" # 0 included tags, 2 excluded tags Use case An example of this would be if your test pack runs a cron job, where you only want certain tests/feature files to be run within this cron……with the caveat that these cron tests SHOULD NOT also be run in your CI stage upon a push or merge to main. The excluded_tags would then contain the “cron test” tags as a default as these should be ignored in your CI stage. Then in your cron step, use the bundle exec rake command as before, but then pass the “cron tests” tag in here instead, ensuring that all other tags will be ignored and only your appropriately tagged tests will be run.\nThis is more elegant than writing:\ntags = args.tag.nil? ? 'not @exclude' : \"#{args.tag} and not @excluded_tag1 and not @excluded_tag2 and not @excluded_tag3.....\" By using the array, you can add an excluded_tagto the running of the tests without programmatically making any code changes to existing tests. This elegant method also looks cleaner.\nConclusion Using this method allows any test pack to run and/or ignore certain tests within certain environments when the need arises, without making any drastic code changes or amending the default bundle exec rake command to run the tests in parallel.\n","wordCount":"580","inLanguage":"en","datePublished":"2024-07-02T00:00:00Z","dateModified":"2024-07-02T00:00:00Z","author":{"@type":"Person","name":"Tomos Griffiths"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dvla.github.io/posts/2024-07-adding-numerous-tags-to-paralleltests-in-cucumber-elegantly/"},"publisher":{"@type":"Organization","name":"DVLA Engineering","logo":{"@type":"ImageObject","url":"https://dvla.github.io/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://dvla.github.io/ accesskey=h title="DVLA Engineering (Alt + H)"><img src=https://dvla.github.io/favicon/apple-touch-icon.png alt aria-label=logo height=49>DVLA Engineering</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://dvla.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://dvla.github.io/open-source/ title=Open-source><span>Open-source</span></a></li><li><a href=https://github.com/dvla/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.civil-service-careers.gov.uk/departments/working-for-the-driver-and-vehicle-licensing-agency/ title=Careers><span>Careers</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://dvla.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://dvla.github.io/posts/>Posts</a></div><h1 class=post-title>TiL: Adding numerous tags to ParallelTests in cucumber elegantly</h1><div class=post-description>Creating numerous tags to be included/excluded for ParallelTests in cucumber elegantly</div><div class=post-meta><span title='2024-07-02 00:00:00 +0000 UTC'>July 2, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;580 words&nbsp;·&nbsp;Tomos Griffiths</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#using-included-and-excluded-tags>Using &lsquo;included&rsquo; and &rsquo;excluded&rsquo; tags</a></li><li><a href=#use-case>Use case</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><p>Trying to run tests in parallel in your CI/CD pipeline is tricky at the best of times, but what if you have tests which should only be run in a certain environment and not as part of the CI build stage?</p><p>It is fairly simple to just tag a feature file with a unique tag that can then be passed to the <code>bundle exec rake</code> command in the functional-tests step, as an environment variable. However, this tag will not stop these tests being run as part of the CI stage unless you make changes to how the tags are being used.</p><p>A useful way is by adopting the approach described below:</p><h2 id=using-included-and-excluded-tags>Using &lsquo;included&rsquo; and &rsquo;excluded&rsquo; tags<a hidden class=anchor aria-hidden=true href=#using-included-and-excluded-tags>#</a></h2><p>By using a set of <code>included</code> and <code>excluded</code> tags, we can pass in the tags we want to use within a particular rake task, and also the tags we want to exclude from this task. We can do this easily and elegantly by using an array for each as below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl>  <span class=c1># To exclude more tags in the running of the tests, add the argument to the &#39;excluded_tags&#39; array below</span>
</span></span><span class=line><span class=cl>  <span class=n>task</span> <span class=ss>:run</span><span class=p>,</span> <span class=o>%</span><span class=n>i</span><span class=o>[</span><span class=n>threads</span> <span class=n>feature_path</span> <span class=n>tags</span> <span class=n>excluded_tags</span><span class=o>]</span> <span class=k>do</span> <span class=o>|</span><span class=n>_t</span><span class=p>,</span> <span class=n>args</span><span class=o>|</span>
</span></span><span class=line><span class=cl>    <span class=n>args</span><span class=o>.</span><span class=n>with_defaults</span><span class=p>(</span><span class=ss>threads</span><span class=p>:</span> <span class=s1>&#39;1&#39;</span><span class=p>,</span> <span class=ss>feature_path</span><span class=p>:</span> <span class=s1>&#39;features&#39;</span><span class=p>,</span> <span class=ss>tags</span><span class=p>:</span> <span class=s1>&#39;[]&#39;</span><span class=p>,</span> <span class=ss>excluded_tags</span><span class=p>:</span> <span class=s2>&#34;[&#39;@exclude&#39;]&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># puts the array of excluded_tags into a string to use in the tags argument below</span>
</span></span><span class=line><span class=cl>    <span class=n>excluded_tags</span> <span class=o>=</span> <span class=no>JSON</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>excluded_tags</span><span class=p>)</span><span class=o>.</span><span class=n>map</span> <span class=p>{</span> <span class=o>|</span><span class=n>tag</span><span class=o>|</span> <span class=s2>&#34;not </span><span class=si>#{</span><span class=n>tag</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>included_tags</span> <span class=o>=</span> <span class=no>JSON</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=n>args</span><span class=o>.</span><span class=n>tags</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>tags</span> <span class=o>=</span> <span class=n>included_tags</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>excluded_tags</span><span class=p>)</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39; and &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># tags = args.tag.nil? ? &#39;not @problematic and not @retention&#39; : args.tag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=no>LOG</span><span class=o>.</span><span class=n>info</span> <span class=p>{</span> <span class=s2>&#34;Threads: &#39;</span><span class=si>#{</span><span class=n>args</span><span class=o>.</span><span class=n>threads</span><span class=si>}</span><span class=s2>&#39; | Feature path: &#39;</span><span class=si>#{</span><span class=n>args</span><span class=o>.</span><span class=n>feature_path</span><span class=si>}</span><span class=s2>&#39; | Tags: &#39;</span><span class=si>#{</span><span class=n>tags</span><span class=si>}</span><span class=s2>&#39; | Formatter: &#39;</span><span class=si>#{</span><span class=n>cucumber_formatter</span><span class=si>}</span><span class=s2>&#39;&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>parallel</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=o>[</span><span class=s1>&#39;-n&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>threads</span><span class=p>,</span> <span class=s1>&#39;--type&#39;</span><span class=p>,</span> <span class=s1>&#39;cucumber&#39;</span><span class=p>,</span> <span class=s1>&#39;--group-by&#39;</span><span class=p>,</span> <span class=s1>&#39;scenarios&#39;</span><span class=p>,</span> <span class=s1>&#39;--serialize-stdout&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=s1>&#39;-f&#39;</span><span class=p>,</span> <span class=n>cucumber_formatter</span><span class=p>,</span> <span class=s1>&#39;--out&#39;</span><span class=p>,</span> <span class=s1>&#39;/dev/null&#39;</span><span class=p>,</span> <span class=s1>&#39;-f&#39;</span><span class=p>,</span> <span class=s1>&#39;progress&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=s1>&#39;-t&#39;</span><span class=p>,</span> <span class=n>tags</span><span class=p>,</span> <span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>feature_path</span><span class=o>]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=k>end</span>
</span></span></code></pre></div><p>The <code>tags</code> can then be passed in to the <code>parallel.run</code> command we are all familiar with. This ensures that we are running the tests that have been tagged appropriately but also excludes any tags that should not be added to this command.</p><p>In your <code>drone.yml</code> file, be sure to use the escape character () correctly in order to pass in the tags correctly, i.e.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl>  <span class=n>bundle</span> <span class=nb>exec</span> <span class=n>rake</span> <span class=s2>&#34;functional_tests:run[1, features/tests, [</span><span class=se>\&#34;</span><span class=s2>@included_tag</span><span class=se>\&#34;</span><span class=s2>], [</span><span class=se>\&#34;</span><span class=s2>@excluded_tag</span><span class=se>\&#34;</span><span class=s2>]]&#34;</span> <span class=c1># 1 included tag, 1 excluded tag</span>
</span></span><span class=line><span class=cl>  <span class=no>OR</span>
</span></span><span class=line><span class=cl>  <span class=n>bundle</span> <span class=nb>exec</span> <span class=n>rake</span> <span class=s2>&#34;functional_tests:run[2, features/tests, [], [</span><span class=se>\&#34;</span><span class=s2>@excluded_tag1</span><span class=se>\&#34;</span><span class=s2> \,\ </span><span class=se>\&#34;</span><span class=s2>@excluded_tag2</span><span class=se>\&#34;</span><span class=s2>]]&#34;</span> <span class=c1># 0 included tags, 2 excluded tags</span>
</span></span></code></pre></div><h2 id=use-case>Use case<a hidden class=anchor aria-hidden=true href=#use-case>#</a></h2><p>An example of this would be if your test pack runs a <code>cron</code> job, where you only want certain tests/feature files to be run within this cron&mldr;&mldr;with the caveat that these <code>cron</code> tests SHOULD NOT also be run in your CI stage upon a <code>push</code> or <code>merge to main</code>. The <code>excluded_tags</code> would then contain the &ldquo;cron test&rdquo; tags as a default as these should be ignored in your CI stage. Then in your <code>cron</code> step, use the <code>bundle exec rake</code> command as before, but then pass the &ldquo;cron tests&rdquo; tag in here instead, ensuring that all other tags will be ignored and only your appropriately tagged tests will be run.</p><p>This is more elegant than writing:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl>  <span class=n>tags</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>tag</span><span class=o>.</span><span class=n>nil?</span> <span class=p>?</span> <span class=s1>&#39;not @exclude&#39;</span> <span class=p>:</span> <span class=s2>&#34;</span><span class=si>#{</span><span class=n>args</span><span class=o>.</span><span class=n>tag</span><span class=si>}</span><span class=s2> and not @excluded_tag1 and not @excluded_tag2 and not @excluded_tag3.....&#34;</span>
</span></span></code></pre></div><p>By using the array, you can add an <code>excluded_tag</code>to the running of the tests without programmatically making any code changes to existing tests. This elegant method also looks cleaner.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Using this method allows any test pack to run and/or ignore certain tests within certain environments when the need arises, without making any drastic code changes or amending the default <code>bundle exec rake</code> command to run the tests in parallel.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://dvla.github.io/tags/ruby/>Ruby</a></li><li><a href=https://dvla.github.io/tags/paralleltests/>ParallelTests</a></li><li><a href=https://dvla.github.io/tags/tags/>Tags</a></li><li><a href=https://dvla.github.io/tags/cucumber/>Cucumber</a></li><li><a href=https://dvla.github.io/tags/testing/>Testing</a></li><li><a href=https://dvla.github.io/tags/today-i-learned/>Today I Learned</a></li></ul><nav class=paginav><a class=prev href=https://dvla.github.io/posts/2024-07-non-blocking-ruby-methods/><span class=title>« Prev</span><br><span>Non-Blocking Ruby Methods</span></a>
<a class=next href=https://dvla.github.io/posts/2024-03-streamline-application-processing/><span class=title>Next »</span><br><span>How AWS Step Functions helped streamline the DVLA's application process</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://dvla.github.io/>DVLA Engineering</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>