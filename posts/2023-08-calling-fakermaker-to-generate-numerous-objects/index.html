<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TiL: Generating numerous FakerMaker objects in one call | DVLA Engineering</title><meta name=keywords content="Ruby,FakerMaker,Faker,Testing,Today I Learned"><meta name=description content="Creating numerous FakerMaker objects and storing in an Array, in one call."><meta name=author content="Tomos Griffiths"><link rel=canonical href=https://dvla.github.io/posts/2023-08-calling-fakermaker-to-generate-numerous-objects/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://dvla.github.io/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://dvla.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://dvla.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://dvla.github.io/favicon/apple-touch-icon.png><link rel=mask-icon href=https://dvla.github.io/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://dvla.github.io/posts/2023-08-calling-fakermaker-to-generate-numerous-objects/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WH4N9FEEE8"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WH4N9FEEE8")}</script><meta property="og:url" content="https://dvla.github.io/posts/2023-08-calling-fakermaker-to-generate-numerous-objects/"><meta property="og:site_name" content="DVLA Engineering"><meta property="og:title" content="TiL: Generating numerous FakerMaker objects in one call"><meta property="og:description" content="Creating numerous FakerMaker objects and storing in an Array, in one call."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-22T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-22T00:00:00+00:00"><meta property="article:tag" content="Ruby"><meta property="article:tag" content="FakerMaker"><meta property="article:tag" content="Faker"><meta property="article:tag" content="Testing"><meta property="article:tag" content="Today I Learned"><meta property="og:image" content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="TiL: Generating numerous FakerMaker objects in one call"><meta name=twitter:description content="Creating numerous FakerMaker objects and storing in an Array, in one call."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://dvla.github.io/posts/"},{"@type":"ListItem","position":2,"name":"TiL: Generating numerous FakerMaker objects in one call","item":"https://dvla.github.io/posts/2023-08-calling-fakermaker-to-generate-numerous-objects/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TiL: Generating numerous FakerMaker objects in one call","name":"TiL: Generating numerous FakerMaker objects in one call","description":"Creating numerous FakerMaker objects and storing in an Array, in one call.","keywords":["Ruby","FakerMaker","Faker","Testing","Today I Learned"],"articleBody":"Trying to generate numerous, realistic-looking objects for automation testing can be difficult.\nUsing FakerMaker to do just that is preferable; using factories with Faker to dynamically create the test data you need in whatever format you need, is far better than using fixtures.\nBut what if you needed more than one object of the particular factory that you have created?\nCreating a factory We can use Faker and FakerMaker to create an individual factory for an API request body like this:\nrequire 'faker' require 'faker_maker' FakerMaker.factory :grocery_order do id(json: 'id', omit: :nil) { Faker::Number.number(digits: 14).to_s } timestamp(json: 'timestamp', omit: :nil) { DateTime.now } frozen_food(json: 'frozenFood', omit: :nil) { FakerMaker[:frozenFood].build } cupboard_items(json: 'cupboardItems', omit: :nil) { FakerMaker[:cupboardItems].build } fridge_items(json: 'fridgeItems', omit: :nil) { FakerMaker[:fridgeItems].build } snack_items(json: 'snackItems', omit: :nil) { FakerMaker[:snackItems].build } drink_items(json: 'drinkItems', omit: :nil) { FakerMaker[:drinkItems].build } alcohol_items(json: 'alcoholItems', omit: :nil) { FakerMaker[:alcoholItems].build } grocery_total(json: 'groceryTotal', omit: :nil) {Faker::Number.number(digits: 6).to_s } end But what if the test requires MORE THAN ONE instance of this fairly complex object be generated?\nCreating multiple instances of the FM factory object This can be done in 2 ways:\nUsing Array.new: multiple_orders = Array.new(3) { FM[:grocery_order].build.as_json } This will create a new array of length 3 AND build 3 instances of the grocery_order object. The multiple_orders array can then be returned for your tests.\nUsing .map: multiple_orders = 3.times.map { FM[:grocery_order].build.as_json } This will do the exact same thing as the above. This is a more elegant way of writing the above code, and is more readable, in my opinion.\nAnd that is it!\nConclusion For complex objects, such as the example above, it can be beneficial to reproduce numerous objects to be stored in test artefacts to ensure your application or system can handle them within the response. This is especially useful when there can be numerous instances of certain objects held.\n","wordCount":"309","inLanguage":"en","image":"https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2023-08-22T00:00:00Z","dateModified":"2023-08-22T00:00:00Z","author":{"@type":"Person","name":"Tomos Griffiths"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dvla.github.io/posts/2023-08-calling-fakermaker-to-generate-numerous-objects/"},"publisher":{"@type":"Organization","name":"DVLA Engineering","logo":{"@type":"ImageObject","url":"https://dvla.github.io/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://dvla.github.io/ accesskey=h title="DVLA Engineering (Alt + H)"><img src=https://dvla.github.io/favicon/apple-touch-icon.png alt aria-label=logo height=49>DVLA Engineering</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://dvla.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://dvla.github.io/open-source/ title=Open-source><span>Open-source</span></a></li><li><a href=https://github.com/dvla/ title=Github><span>Github</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.civil-service-careers.gov.uk/departments/working-for-the-driver-and-vehicle-licensing-agency/ title=Careers><span>Careers</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://dvla.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://dvla.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">TiL: Generating numerous FakerMaker objects in one call</h1><div class=post-description>Creating numerous FakerMaker objects and storing in an Array, in one call.</div><div class=post-meta><span title='2023-08-22 00:00:00 +0000 UTC'>August 22, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;309 words&nbsp;·&nbsp;Tomos Griffiths</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#creating-a-factory>Creating a factory</a></li><li><a href=#creating-multiple-instances-of-the-fm-factory-object>Creating multiple instances of the FM factory object</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div><div class=post-content><p>Trying to generate numerous, realistic-looking objects for automation testing can be difficult.</p><p>Using <a href=https://billyruffian.github.io/faker_maker/>FakerMaker</a> to do just that is preferable; using factories with <a href=https://github.com/faker-ruby/faker>Faker</a> to dynamically create the test data you need in whatever format you need, is far better than using fixtures.</p><p>But what if you needed more than one object of the particular factory that you have created?</p><h2 id=creating-a-factory>Creating a factory<a hidden class=anchor aria-hidden=true href=#creating-a-factory>#</a></h2><p>We can use Faker and FakerMaker to create an individual factory for an API request body like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;faker&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>require</span> <span class=s1>&#39;faker_maker&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>.</span><span class=n>factory</span> <span class=ss>:grocery_order</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=nb>id</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;id&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Number</span><span class=o>.</span><span class=n>number</span><span class=p>(</span><span class=ss>digits</span><span class=p>:</span> <span class=mi>14</span><span class=p>)</span><span class=o>.</span><span class=n>to_s</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>timestamp</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;timestamp&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>DateTime</span><span class=o>.</span><span class=n>now</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>frozen_food</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;frozenFood&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:frozenFood</span><span class=o>].</span><span class=n>build</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>cupboard_items</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;cupboardItems&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:cupboardItems</span><span class=o>].</span><span class=n>build</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>fridge_items</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;fridgeItems&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:fridgeItems</span><span class=o>].</span><span class=n>build</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>snack_items</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;snackItems&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:snackItems</span><span class=o>].</span><span class=n>build</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>drink_items</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;drinkItems&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:drinkItems</span><span class=o>].</span><span class=n>build</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>alcohol_items</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;alcoholItems&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span> <span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:alcoholItems</span><span class=o>].</span><span class=n>build</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>grocery_total</span><span class=p>(</span><span class=ss>json</span><span class=p>:</span> <span class=s1>&#39;groceryTotal&#39;</span><span class=p>,</span> <span class=ss>omit</span><span class=p>:</span> <span class=ss>:nil</span><span class=p>)</span> <span class=p>{</span><span class=no>Faker</span><span class=o>::</span><span class=no>Number</span><span class=o>.</span><span class=n>number</span><span class=p>(</span><span class=ss>digits</span><span class=p>:</span> <span class=mi>6</span><span class=p>)</span><span class=o>.</span><span class=n>to_s</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span></code></pre></div><p>But what if the test requires MORE THAN ONE instance of this fairly complex object be generated?</p><h2 id=creating-multiple-instances-of-the-fm-factory-object>Creating multiple instances of the FM factory object<a hidden class=anchor aria-hidden=true href=#creating-multiple-instances-of-the-fm-factory-object>#</a></h2><p>This can be done in 2 ways:</p><ol><li>Using Array.new:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>multiple_orders</span> <span class=o>=</span> <span class=nb>Array</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span> <span class=p>{</span> <span class=no>FM</span><span class=o>[</span><span class=ss>:grocery_order</span><span class=o>].</span><span class=n>build</span><span class=o>.</span><span class=n>as_json</span> <span class=p>}</span>
</span></span></code></pre></div><p>This will create a new array of length 3 AND build 3 instances of the grocery_order object. The multiple_orders array can then be returned for your tests.</p><ol start=2><li>Using .map:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>multiple_orders</span> <span class=o>=</span> <span class=mi>3</span><span class=o>.</span><span class=n>times</span><span class=o>.</span><span class=n>map</span> <span class=p>{</span> <span class=no>FM</span><span class=o>[</span><span class=ss>:grocery_order</span><span class=o>].</span><span class=n>build</span><span class=o>.</span><span class=n>as_json</span> <span class=p>}</span>
</span></span></code></pre></div><p>This will do the exact same thing as the above. This is a more elegant way of writing the above code, and is more readable, in my opinion.</p><p>And that is it!</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>For complex objects, such as the example above, it can be beneficial to reproduce numerous objects to be stored in test artefacts to ensure your application or system can handle them within the response. This is especially useful when there can be numerous instances of certain objects held.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://dvla.github.io/tags/ruby/>Ruby</a></li><li><a href=https://dvla.github.io/tags/fakermaker/>FakerMaker</a></li><li><a href=https://dvla.github.io/tags/faker/>Faker</a></li><li><a href=https://dvla.github.io/tags/testing/>Testing</a></li><li><a href=https://dvla.github.io/tags/today-i-learned/>Today I Learned</a></li></ul><nav class=paginav><a class=prev href=https://dvla.github.io/posts/2023-08-at-exit-hook/><span class=title>« Prev</span><br><span>The at_exit function</span>
</a><a class=next href=https://dvla.github.io/posts/2023-07-taking-full-length-screenshots/><span class=title>Next »</span><br><span>TiL: Take full-length screenshots using DevTools</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://dvla.github.io/>DVLA Engineering</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>