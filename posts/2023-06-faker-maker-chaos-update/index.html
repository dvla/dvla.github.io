<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>FakerMaker Chaos Mode Update | DVLA Engineering</title><meta name=keywords content="Ruby,Chaos,FakerMaker,Testing,Today I Learned,Gem"><meta name=description content="Introducing the Chaos mode update for FakerMaker"><meta name=author content="Alexander O'Mahoney"><link rel=canonical href=https://dvla.github.io/posts/2023-06-faker-maker-chaos-update/><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://dvla.github.io/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://dvla.github.io/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://dvla.github.io/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://dvla.github.io/favicon/apple-touch-icon.png><link rel=mask-icon href=https://dvla.github.io/favicon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-WH4N9FEEE8"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-WH4N9FEEE8",{anonymize_ip:!1})}</script><meta property="og:title" content="FakerMaker Chaos Mode Update"><meta property="og:description" content="Introducing the Chaos mode update for FakerMaker"><meta property="og:type" content="article"><meta property="og:url" content="https://dvla.github.io/posts/2023-06-faker-maker-chaos-update/"><meta property="og:image" content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-16T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-16T00:00:00+00:00"><meta property="og:site_name" content="DVLA Engineering"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://dvla.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="FakerMaker Chaos Mode Update"><meta name=twitter:description content="Introducing the Chaos mode update for FakerMaker"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://dvla.github.io/posts/"},{"@type":"ListItem","position":2,"name":"FakerMaker Chaos Mode Update","item":"https://dvla.github.io/posts/2023-06-faker-maker-chaos-update/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"FakerMaker Chaos Mode Update","name":"FakerMaker Chaos Mode Update","description":"Introducing the Chaos mode update for FakerMaker","keywords":["Ruby","Chaos","FakerMaker","Testing","Today I Learned","Gem"],"articleBody":"TL:DR Level up your testing by introducing some chaos to your test data.\nFakerMaker is an incredible factory builder used to generate test data.\nWhen introduced to a test-pack (alongside Faker), it elevates tests by introducing dynamic test data to ensure we’re not constantly testing with the same old boring static data.\nFakerMaker.factory :some_fancy_object, naming: :json do some_required_attribute { Faker::Lorem.sentence } some_optional_attribute_1 { Faker::Lorem.word } some_optional_attribute_2 { Faker::Lorem.word } some_optional_attribute_3 { Faker::Lorem.word } some_optional_attribute_4 { Faker::Lorem.word } end FakerMaker[:some_fancy_object].build.as_json # =\u003e {\"someRequiredAttribute\"=\u003e\"Nulla omnis dolore enim.\", \"someOptionalAttribute1\"=\u003e\"qui\", \"someOptionalAttribute2\"=\u003e\"deserunt\", \"someOptionalAttribute3\"=\u003e\"rerum\", \"someOptionalAttribute4\"=\u003e\"facilis\"} FakerMaker[:some_fancy_object].build.as_json # =\u003e {\"someRequiredAttribute\"=\u003e\"Aut repellendus ut quod.\", \"someOptionalAttribute1\"=\u003e\"consequatur\", \"someOptionalAttribute2\"=\u003e\"quod\", \"someOptionalAttribute3\"=\u003e\"pariatur\", \"someOptionalAttribute4\"=\u003e\"rerum\"} This is a super effective way of ensuring data within an attribute is dynamic, but can we take this further?\nChaos Engineering Chaos engineering is a concept that has been around since the early 2000s. The idea is simple - can we build resilient, fault-tolerant services and how do we prove this?\nHow does a service cope when it loses connection to a database? What about a service that has gone down that our service depends on?\nTo prove a system is resilient against these types of issues we might experiment and replicate these issues to monitor the impact. Remove the database connection, terminate a dependent service etc.\nIn general, cause chaos. So let’s take that concept, and apply it to something like test data!\nIntroducing Chaos for FakerMaker FakerMaker v2 introduces chaos mode.\nLet’s explore the some_fancy_object example from earlier. This time with chaos enabled.\nFakerMaker.factory :some_fancy_object, naming: :json do some_required_attribute_1(required: true) { Faker::Lorem.sentence } some_required_attribute_2(optional: false) { Faker::Lorem.word } some_optional_attribute_1 { Faker::Lorem.word } some_optional_attribute_2(optional: 90) { Faker::Lorem.word } some_optional_attribute_3(optional: 10) { Faker::Lorem.word } end FakerMaker[:some_fancy_object].build(chaos: true).as_json # =\u003e {\"someRequiredAttribute1\"=\u003e\"Sed rem magnam placeat.\", \"someRequiredAttribute2\"=\u003e\"nemo\", \"someOptionalAttribute2\"=\u003e\"dolores\"} FakerMaker[:some_fancy_object].build(chaos: true).as_json # =\u003e {\"someRequiredAttribute1\"=\u003e\"Hic neque aut sapiente.\", \"someRequiredAttribute2\"=\u003e\"saepe\", \"someOptionalAttribute1\"=\u003e\"id\"} FakerMaker[:some_fancy_object].build(chaos: true).as_json # =\u003e {\"someRequiredAttribute1\"=\u003e\"Fuga est rerum quia.\", \"someRequiredAttribute2\"=\u003e\"vero\", \"someOptionalAttribute2\"=\u003e\"nulla\", \"someOptionalAttribute1\"=\u003e\"dolorem\"} When a factory is built with chaos enabled, optional fields become truly optional and may not be present in the built factory.\nNot only is the data dynamic per attribute, but the attributes themselves are now dynamic … chaos!\nLets dig in a bit …\nAttribute metadata Attributes can now be tagged as required or optional.\nsome_required_attribute_1(required: true) { Faker::Lorem.sentence } some_optional_attribute_1(optional: true) { Faker::Lorem.sentence } By default, all attributes are optional.\nYou can also pass through an optional weighting. This determines the likelihood of that attribute appearing in your built factory\nsome_optional_attribute_1(optional: 90) { Faker::Lorem.sentence } # 90% chance this attribute will be present some_optional_attribute_2(optional: 10) { Faker::Lorem.sentence } # 10% chance this attribute will be present By default, all optional attributes are weighted at 50%.\nMetadata on attributes provides some benefits without chaos enabled.\nFactories are often modelling schemas listed in API contracts. These contracts state which fields are required.\nBy having this data available on the factory it gives us at a glance information at the data we are modeling without the hassle of checking API contracts.\nEnabling Chaos Chaos is enabled when a factory object is built by passing the chaos flag.\nFakerMaker[:some_fancy_object].build(chaos: true) You can also specify which fields to run chaos over by passing an Array.\nFakerMaker[:some_fancy_object].build(chaos: %i[some_optional_attribute_1]) Chaos will only run on some_optional_attribute_1 and not against the other optional attributes.\nWhy would I want this? By using this approach to testing, we are more closely mimicking real life scenarios.\nData comes in all shapes and sizes, especially when optional attributes come into play.\nHow do you know an APIs optional field is truly optional? How do you know your beautiful webpage that displays data with optional fields will actually work?\nChaos introduces new combinations of tests without the hassle or mess of doing it yourself.\nTL:DR Every attribute is optional by default Optional attributes maybe removed when your factory is built and chaos is enabled Attributes can be marked as required - required attributes will always be present You can add weighting to individual optional attributes to determine the likelihood of them being present You can run chaos over a subset of optional attributes when building your factory ","wordCount":"672","inLanguage":"en","datePublished":"2023-06-16T00:00:00Z","dateModified":"2023-06-16T00:00:00Z","author":{"@type":"Person","name":"Alexander O'Mahoney"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://dvla.github.io/posts/2023-06-faker-maker-chaos-update/"},"publisher":{"@type":"Organization","name":"DVLA Engineering","logo":{"@type":"ImageObject","url":"https://dvla.github.io/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://dvla.github.io/ accesskey=h title="DVLA Engineering (Alt + H)"><img src=https://dvla.github.io/favicon/apple-touch-icon.png alt aria-label=logo height=49>DVLA Engineering</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://dvla.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://dvla.github.io/open-source/ title=Open-source><span>Open-source</span></a></li><li><a href=https://github.com/dvla/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.civil-service-careers.gov.uk/departments/working-for-the-driver-and-vehicle-licensing-agency/ title=Careers><span>Careers</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://dvla.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://dvla.github.io/posts/>Posts</a></div><h1 class=post-title>FakerMaker Chaos Mode Update</h1><div class=post-description>Introducing the Chaos mode update for FakerMaker</div><div class=post-meta><span title='2023-06-16 00:00:00 +0000 UTC'>June 16, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;672 words&nbsp;·&nbsp;Alexander O'Mahoney</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#chaos-engineering>Chaos Engineering</a></li><li><a href=#introducing-chaos-for-fakermaker>Introducing Chaos for FakerMaker</a><ul><li><a href=#attribute-metadata>Attribute metadata</a></li><li><a href=#enabling-chaos>Enabling Chaos</a></li><li><a href=#why-would-i-want-this>Why would I want this?</a></li><li><a href=#tldr>TL:DR</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><strong>TL:DR Level up your testing by introducing some chaos to your test data.</strong></p><p>FakerMaker is an incredible factory builder used to generate test data.</p><p>When introduced to a test-pack (alongside Faker), it elevates tests by introducing dynamic test data to ensure
we&rsquo;re not constantly testing with the same old boring static data.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>.</span><span class=n>factory</span> <span class=ss>:some_fancy_object</span><span class=p>,</span> <span class=ss>naming</span><span class=p>:</span> <span class=ss>:json</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=n>some_required_attribute</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>sentence</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_optional_attribute_1</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_optional_attribute_2</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_optional_attribute_3</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_optional_attribute_4</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:some_fancy_object</span><span class=o>].</span><span class=n>build</span><span class=o>.</span><span class=n>as_json</span> 
</span></span><span class=line><span class=cl><span class=c1># =&gt; {&#34;someRequiredAttribute&#34;=&gt;&#34;Nulla omnis dolore enim.&#34;, &#34;someOptionalAttribute1&#34;=&gt;&#34;qui&#34;, &#34;someOptionalAttribute2&#34;=&gt;&#34;deserunt&#34;, &#34;someOptionalAttribute3&#34;=&gt;&#34;rerum&#34;, &#34;someOptionalAttribute4&#34;=&gt;&#34;facilis&#34;}</span>
</span></span><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:some_fancy_object</span><span class=o>].</span><span class=n>build</span><span class=o>.</span><span class=n>as_json</span> 
</span></span><span class=line><span class=cl><span class=c1># =&gt; {&#34;someRequiredAttribute&#34;=&gt;&#34;Aut repellendus ut quod.&#34;, &#34;someOptionalAttribute1&#34;=&gt;&#34;consequatur&#34;, &#34;someOptionalAttribute2&#34;=&gt;&#34;quod&#34;, &#34;someOptionalAttribute3&#34;=&gt;&#34;pariatur&#34;, &#34;someOptionalAttribute4&#34;=&gt;&#34;rerum&#34;}</span>
</span></span></code></pre></div><p>This is a super effective way of ensuring data within an attribute is dynamic, but can we take this further?</p><h2 id=chaos-engineering>Chaos Engineering<a hidden class=anchor aria-hidden=true href=#chaos-engineering>#</a></h2><p>Chaos engineering is a concept that has been around since the early 2000s. The idea is simple - can we build resilient,
fault-tolerant services and how do we prove this?</p><p>How does a service cope when it loses connection to a database?
What about a service that has gone down that our service depends on?</p><p>To prove a system is resilient against these types of issues we might experiment and replicate these issues to monitor
the impact. Remove the database connection, terminate a dependent service etc.</p><p>In general, cause chaos. So let&rsquo;s take that concept, and apply it to something like test data!</p><h2 id=introducing-chaos-for-fakermaker>Introducing Chaos for FakerMaker<a hidden class=anchor aria-hidden=true href=#introducing-chaos-for-fakermaker>#</a></h2><p>FakerMaker v2 introduces chaos mode.</p><p>Let&rsquo;s explore the <code>some_fancy_object</code> example from earlier. This time with chaos enabled.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>.</span><span class=n>factory</span> <span class=ss>:some_fancy_object</span><span class=p>,</span> <span class=ss>naming</span><span class=p>:</span> <span class=ss>:json</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>  <span class=n>some_required_attribute_1</span><span class=p>(</span><span class=ss>required</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>sentence</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_required_attribute_2</span><span class=p>(</span><span class=ss>optional</span><span class=p>:</span> <span class=kp>false</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_optional_attribute_1</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_optional_attribute_2</span><span class=p>(</span><span class=ss>optional</span><span class=p>:</span> <span class=mi>90</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=n>some_optional_attribute_3</span><span class=p>(</span><span class=ss>optional</span><span class=p>:</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>word</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:some_fancy_object</span><span class=o>].</span><span class=n>build</span><span class=p>(</span><span class=ss>chaos</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span><span class=o>.</span><span class=n>as_json</span> 
</span></span><span class=line><span class=cl><span class=c1># =&gt; {&#34;someRequiredAttribute1&#34;=&gt;&#34;Sed rem magnam placeat.&#34;, &#34;someRequiredAttribute2&#34;=&gt;&#34;nemo&#34;, &#34;someOptionalAttribute2&#34;=&gt;&#34;dolores&#34;}</span>
</span></span><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:some_fancy_object</span><span class=o>].</span><span class=n>build</span><span class=p>(</span><span class=ss>chaos</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span><span class=o>.</span><span class=n>as_json</span> 
</span></span><span class=line><span class=cl><span class=c1># =&gt; {&#34;someRequiredAttribute1&#34;=&gt;&#34;Hic neque aut sapiente.&#34;, &#34;someRequiredAttribute2&#34;=&gt;&#34;saepe&#34;, &#34;someOptionalAttribute1&#34;=&gt;&#34;id&#34;}</span>
</span></span><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:some_fancy_object</span><span class=o>].</span><span class=n>build</span><span class=p>(</span><span class=ss>chaos</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span><span class=o>.</span><span class=n>as_json</span> 
</span></span><span class=line><span class=cl><span class=c1># =&gt; {&#34;someRequiredAttribute1&#34;=&gt;&#34;Fuga est rerum quia.&#34;, &#34;someRequiredAttribute2&#34;=&gt;&#34;vero&#34;, &#34;someOptionalAttribute2&#34;=&gt;&#34;nulla&#34;, &#34;someOptionalAttribute1&#34;=&gt;&#34;dolorem&#34;}</span>
</span></span></code></pre></div><p>When a factory is built with chaos enabled, optional fields become truly optional and may not be present in the built factory.</p><p>Not only is the data dynamic per attribute, but the attributes themselves are now dynamic &mldr; chaos!</p><p>Lets dig in a bit &mldr;</p><h3 id=attribute-metadata>Attribute metadata<a hidden class=anchor aria-hidden=true href=#attribute-metadata>#</a></h3><p>Attributes can now be tagged as <code>required</code> or <code>optional</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>some_required_attribute_1</span><span class=p>(</span><span class=ss>required</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>sentence</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>some_optional_attribute_1</span><span class=p>(</span><span class=ss>optional</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>sentence</span> <span class=p>}</span>
</span></span></code></pre></div><blockquote><p>By default, all attributes are <code>optional</code>.</p></blockquote><p>You can also pass through an optional weighting. This determines the likelihood of that attribute appearing in your built factory</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=n>some_optional_attribute_1</span><span class=p>(</span><span class=ss>optional</span><span class=p>:</span> <span class=mi>90</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>sentence</span> <span class=p>}</span> <span class=c1># 90% chance this attribute will be present</span>
</span></span><span class=line><span class=cl><span class=n>some_optional_attribute_2</span><span class=p>(</span><span class=ss>optional</span><span class=p>:</span> <span class=mi>10</span><span class=p>)</span> <span class=p>{</span> <span class=no>Faker</span><span class=o>::</span><span class=no>Lorem</span><span class=o>.</span><span class=n>sentence</span> <span class=p>}</span> <span class=c1># 10% chance this attribute will be present</span>
</span></span></code></pre></div><blockquote><p>By default, all <code>optional</code> attributes are weighted at <code>50%</code>.</p></blockquote><p>Metadata on attributes provides some benefits without chaos enabled.</p><p>Factories are often modelling schemas listed in API contracts. These contracts state which fields are required.</p><p>By having this data available on the factory it gives us at a glance information at the data we are modeling without
the hassle of checking API contracts.</p><h3 id=enabling-chaos>Enabling Chaos<a hidden class=anchor aria-hidden=true href=#enabling-chaos>#</a></h3><p>Chaos is enabled when a factory object is built by passing the <code>chaos</code> flag.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:some_fancy_object</span><span class=o>].</span><span class=n>build</span><span class=p>(</span><span class=ss>chaos</span><span class=p>:</span> <span class=kp>true</span><span class=p>)</span>
</span></span></code></pre></div><p>You can also specify which fields to run chaos over by passing an <code>Array</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-ruby data-lang=ruby><span class=line><span class=cl><span class=no>FakerMaker</span><span class=o>[</span><span class=ss>:some_fancy_object</span><span class=o>].</span><span class=n>build</span><span class=p>(</span><span class=ss>chaos</span><span class=p>:</span> <span class=o>%</span><span class=n>i</span><span class=o>[</span><span class=n>some_optional_attribute_1</span><span class=o>]</span><span class=p>)</span>
</span></span></code></pre></div><blockquote><p>Chaos will only run on <code>some_optional_attribute_1</code> and not against the other optional attributes.</p></blockquote><h3 id=why-would-i-want-this>Why would I want this?<a hidden class=anchor aria-hidden=true href=#why-would-i-want-this>#</a></h3><p>By using this approach to testing, we are more closely mimicking real life scenarios.</p><p>Data comes in all shapes and sizes, especially when optional attributes come into play.</p><p>How do you know an APIs optional field is truly optional? How do you know your beautiful webpage that displays data with optional fields will actually work?</p><p>Chaos introduces new combinations of tests without the hassle or mess of doing it yourself.</p><h3 id=tldr>TL:DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h3><ul><li>Every attribute is <code>optional</code> by default</li><li>Optional attributes maybe removed when your factory is built and chaos is enabled</li><li>Attributes can be marked as <code>required</code> - required attributes will always be present</li><li>You can add weighting to individual optional attributes to determine the likelihood of them being present</li><li>You can run chaos over a subset of optional attributes when building your factory</li></ul><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://dvla.github.io/tags/ruby/>Ruby</a></li><li><a href=https://dvla.github.io/tags/chaos/>Chaos</a></li><li><a href=https://dvla.github.io/tags/fakermaker/>FakerMaker</a></li><li><a href=https://dvla.github.io/tags/testing/>Testing</a></li><li><a href=https://dvla.github.io/tags/today-i-learned/>Today I Learned</a></li><li><a href=https://dvla.github.io/tags/gem/>Gem</a></li></ul><nav class=paginav><a class=prev href=https://dvla.github.io/posts/2023-07-taking-full-length-screenshots/><span class=title>« Prev</span><br><span>TiL: Take full-length screenshots using DevTools</span></a>
<a class=next href=https://dvla.github.io/posts/2023-06-efficient-cucumber-step-regex-matching/><span class=title>Next »</span><br><span>Efficient Cucumber Step Regex Matching</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://dvla.github.io/>DVLA Engineering</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>